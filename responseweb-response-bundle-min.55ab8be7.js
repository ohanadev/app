var SM=window.SM||{};if(typeof module=="object"&&module.exports){module.exports=SM}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM")}SM.Object={create:function(e){function t(){}t.prototype=e;return new t},hasKeys:function(e,t){var i=t.length,n=0;for(;n<i;n++){if(!(t[n]in e)){throw new Error("key '"+t[n]+"' is missing")}}},toArray:function(e){var t=[],i;for(i in e){t.push(e[i])}return t},equals:function(e,t){if(e===t){return true}if(!(e instanceof Object)||!(t instanceof Object)){return false}if(e.constructor!==t.constructor){return false}for(var i in e){if(!e.hasOwnProperty(i)){continue}if(!t.hasOwnProperty(i)){return false}if(e[i]===t[i]){continue}if(typeof e[i]!=="object"){return false}if(!SM.Object.equals(e[i],t[i])){return false}}for(i in t){if(t.hasOwnProperty(i)&&!e.hasOwnProperty(i)){return false}}return true}};if(window.Object.create){SM.Object.create=window.Object.create}if(typeof module=="object"&&module.exports){module.exports=SM.Object}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM")}SM.Array={indexOf:function(e,t){var i,n=e.length;for(i=0;i<n;i++){if(e[i]===t){return i}}return-1},getValue:function(e,t){if(t<0){t=0}else if(t>=e.length){t=e.length-1}return e[t]},sortAscending:function(e,t){var i;var n;if(typeof e==="string"){i=e.toLowerCase();n=t.toLowerCase();if(i<n){return 1}else if(i>n){return-1}return 0}else{return e-t}},sortDescending:function(e,t){var i;var n;if(typeof e==="string"){i=e.toLowerCase();n=t.toLowerCase();if(i<n){return-1}else if(i>n){return 1}return 0}else{return t-e}},unique:function(e){var t={},i,n,s,a=e.length,o=[];for(i=0;i<a;i++){n=e[i];t[n]=n}for(s in t){o.push(t[s])}return o},addUnique:function(e,t){var i=this.indexOf(e,t);if(i===-1){e.push(t)}},removeItem:function(e,t){var i=this.indexOf(e,t);if(i!==-1){e.splice(i,1)}}};if(typeof module=="object"&&module.exports){module.exports=SM.Array}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM")}SM.String={r_http_url:/^(https?:\/\/)/,init:function(){this.rtrim=/\S/.test("\xa0")?/^[\s\xA0]+|[\s\xA0]+$/g:/^\s+|\s+$/g},truncate:function(e,t,i){if(!e){return""}if(!t){return e}if(i===undefined){i=true}if(e.length>t){if(i){return e.substring(0,t-3)+"..."}return e.substring(0,t)}return e},endsWith:function(e,t){if(!e||e.length<t.length){return false}return e.substr(e.length-t.length)===t},beginsWith:function(e,t){if(!e||e.length<t.length){return false}return e.substr(0,t.length)===t},afterLast:function(e,t){var i;if(!e){return""}i=e.lastIndexOf(t);if(i===-1){return""}return e.substr(i+1)},beforeFirst:function(e,t){var i;if(!e){return""}i=e.indexOf(t);if(i===-1){return e}return e.substr(0,i)},isHttpUrl:function(e){return this.r_http_url.test(e)},trim:String.prototype.trim?function(e){return e===null?"":String.prototype.trim.call(e)}:function(e){return e===null?"":e.toString().replace(this.rtrim,"")}};SM.String.init();if(typeof module=="object"&&module.exports){module.exports=SM.String}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM")}SM.Math={roundTo:function(e,t){return this._roundTo(e,t,0)},roundPercentageTo:function(e,t){return this._roundTo(e,t,2)},isInt:function(e){if(!isFinite(e)||(typeof e).toLowerCase()!=="number"){return false}return Math.floor(e)===e},toPercentString:function(e,t){if(!isFinite(e)){return"0%"}return""+this.roundPercentageTo(e,t)+"%"},_roundTo:function(e,t,i){var n,s;if(isNaN(e)){return 0}if(e===0){return 0}if(t===undefined){t=1}n=Math.pow(10,t+i)*e;s=Math.pow(10,t);return Math.round(n)/s}};if(typeof module=="object"&&module.exports){module.exports=SM.Math}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM");require("./array")}SM.DOM={SPACE:" ",getClass:function(e){return e.className?e.className:""},hasClass:function(e,t){var i;var n;var s=0;var a;if(!e){return false}i=this.getClass(e).split(this.SPACE);n=t.split(this.SPACE);a=n.length;for(;s<a;s++){if(SM.Array.indexOf(i,n[s])!==-1){return true}}return false},removeClass:function(e,t){var i=this.getClass(e).split(this.SPACE);var n;if(!e||!t){return}n=SM.Array.indexOf(i,t);if(n!==-1){i.splice(n,1);e.className=i.join(this.SPACE)}},contains:function(e,t){var i=t;while(i){if(i===e){return true}i=i.parentNode}return false},addClass:function(e,t){if(!e||!t){return}if(!this.hasClass(e,t)){e.className=this.getClass(e)+this.SPACE+t}},walkChildren:function(e,t){var i=0,n=e.childNodes,s=n.length;var a;for(;i<s;i++){a=n[i];if(a&&a.nodeType===1){t(a)}}},getElementsByClassName:function(e,t){var i;var n;var s;var a=0;var o;t=t||document;if(document.getElementsByClassName){return t.getElementsByClassName(e)}n=[];i=t.all?t.all:t.getElementsByTagName("*");o=i.length;for(;a<o;a++){s=i[a];if(this.hasClass(s,e)){n.push(s)}}return n},getCoordinates:function(e,t){var i=0;var n=0;do{n+=e.offsetLeft;i+=e.offsetTop;e=e.offsetParent;if(t&&e===t){break}}while(e);return{top:i,left:n}}};if(typeof module=="object"&&module.exports){module.exports=SM.DOM}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM")}SM.Event={normalize:function(e){if(e.srcElement){e.target=e.srcElement}if(!e.preventDefault){e.preventDefault=function(){this.returnValue=false}}if(!e.stopPropagation){e.stopPropagation=function(){this.cancelBubble=true}}return e},add:function(e,t,i){var n="on";if(!e){return}function s(e){e=SM.Event.normalize(e);i(e)}if(e.addEventListener){e.addEventListener(t,s,false)}else if(e.attachEvent){e.attachEvent(n+t,s)}else if(e[n+t]){e[n+t]=s}},BLUR:"blur",CHANGE:"change",CLICK:"click",ENTER_KEYPRESS:"enterkeypress",FOCUS:"focus",FOCUSIN:"focusin",FOCUSOUT:"focusout",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEDOWN:"mousedown",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",PASTE:"paste",RESIZE:"resize",SUBMIT:"submit"};if(typeof module=="object"&&module.exports){module.exports=SM.Event}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM")}SM.KeyCodes={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,CAPS:20,ESCAPE:27,SPACE:32,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,AMPERSAND:55,A:65,C:67,V:86,X:88,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,LESS_THAN:188,GREATER_THAN:190,COMMAND:224,isNonAdditiveKey:function(e){return e===SM.KeyCodes.BACKSPACE||e===SM.KeyCodes.END||e===SM.KeyCodes.HOME||e===SM.KeyCodes.LEFT||e===SM.KeyCodes.UP||e===SM.KeyCodes.RIGHT||e===SM.KeyCodes.DOWN||e===SM.KeyCodes.DELETE},getEscapedHtmlContentCharLength:function(e){switch(e){case SM.KeyCodes.AMPERSAND:return 5;case SM.KeyCodes.LESS_THAN:case SM.KeyCodes.GREATER_THAN:return 4;default:return undefined}}};if(typeof module=="object"&&module.exports){module.exports=SM.KeyCodes}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM");require("./object")}SM.Object=$.extend(SM.Object,{deepCopy:function(e){return $.extend(true,{},e)},copy:function(e){return $.extend({},e)},update:function(e,t){$.extend(e,t)},deepUpdate:function(e,t){var i=Array.prototype.concat.apply([true],arguments);return $.extend.apply($,i)},extend:function(e,t){var i=Array.prototype.concat.apply([{}],arguments);return $.extend.apply($,i)},deepExtend:function(e,t){var i=Array.prototype.concat.apply([true,{}],arguments);return $.extend.apply($,i)}});if(typeof module=="object"&&module.exports){module.exports=SM.Object}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM")}SM.PubSub={$document:$(window.document),subscribe:function(e,t,i){if(!this.on){return this}if(e===null||e===undefined){throw new Error("SM.PubSub: subscribing to a null or undefined event")}if(t===undefined||t===null){throw new Error("SM.PubSub: subscribing to "+e+"without a callback")}if(arguments.length===3){this.$document.on(e,i,t)}else{this.$document.on(e,t)}return this},unsubscribe:function(e,t){if(!this.on){return this}if(e===null||e===undefined){throw new Error("SM.PubSub: unsubscribing to a null or undefined event")}if(arguments.length===2){this.$document.off(e,t)}else{this.$document.off(e)}},publish:function(e){var t={};if(!this.on){return this}if(e===null||e===undefined){throw new Error("SM.PubSub: publishing a null or undefined event")}if(typeof e==="string"){t.type=e}else{if(e.type===null||e.type===undefined){throw new Error("SM.PubSub: publishing a null or undefined event")}t=e}this.$document.trigger(t);return this},time:function(e,t,i){var n,s,a=$.Deferred();if(!this.on){return this}if(arguments.length===3){SM.PubSub.subscribe(e,function(e){n=(new Date).getTime()},i);SM.PubSub.subscribe(t,function(e){s=(new Date).getTime()-n;a.notify(s,e)},i)}else{SM.PubSub.subscribe(e,function(e){n=(new Date).getTime()});SM.PubSub.subscribe(t,function(e){s=(new Date).getTime()-n;a.notify(s,e)})}return a},on:true};if(typeof module=="object"&&module.exports){module.exports=SM.PubSub}if(typeof module=="object"&&module.exports&&typeof require=="function"){var SM=require("../SM")}SM.Widget={__NAME:undefined,__init:undefined,__destroy:undefined,__setters:undefined,__getters:undefined,__counter:0,__defaults:undefined,el:undefined,$el:undefined,__settings:undefined,__uid:undefined,get:function(e,t){var i=this.__getters;if(e===undefined){return}if(i&&i[e]){return i[e](this,t)}else{return this.__settings[e]}},set:function(e,t){var i=this.__setters;if(arguments.length===2){if(i&&i[e]){i[e](this,t)}else{this.__settings[e]=t}}return this},destroy:function(){if(this.__destroy){this.__destroy()}},__$document:$(document),__subscribe:function(e,t,i){if(!i){i={}}if(e===undefined){throw new Error("__subscribe: tried to subscribe to undefined event")}if(t===undefined){throw new Error("__subscribe: subscribing with an undefined callback")}i[this.__NAME]=this;i["self"]=this;SM.PubSub.subscribe(e+"."+this.__NAME+this.__uid,t,i);return this},__unsubscribe:function(e,t){if(e===undefined){throw new Error("__unsubscribe: tried to unsubscribe to undefined event")}SM.PubSub.unsubscribe(e+"."+this.__NAME+this.__uid,t);return this},__trigger:function(e){var t={};if(e===undefined){throw new Error("__trigger: tried to trigger an undefined event")}if(typeof e==="string"){t.type=this.__NAME+"."+e}else{if(e.type===undefined){throw new Error("__trigger: tried to trigger an undefined event")}t=e;t.type=this.__NAME+"."+e.type}t[this.__NAME]=this;this.$el.trigger(t);return this},subscribe:function(){this.__subscribe.apply(this,arguments);return this},trigger:function(){this.__trigger.apply(this,arguments);return this},unsubscribe:function(){this.__unsubscribe.apply(this,arguments);return this},bind:function(e,t,i){if(arguments.length===2){i=t;if(typeof i!=="function"){throw new Error("bind takes event, delegate, callback or event, callback")}this.$el.on(e,{self:this},i)}else if(arguments.length===3){this.$el.on(e,t,{self:this},i)}else{throw new Error("bind takes event, delegate, callback or event, callback")}return this},__initSettings:function(e){var t,i,n;this.__settings={};if(e){i={};n={};if(this.__defaults){for(t in this.__defaults){if(this.__defaults.hasOwnProperty(t)&&e.hasOwnProperty(t)){n[t]=e[t]}}for(t in e){if(e.hasOwnProperty(t)&&!this.__defaults.hasOwnProperty(t)){i[t]=e[t]}}this.__settings=SM.Object.deepExtend(this.__defaults,n)}else{i=e}SM.Object.update(this.__settings,i)}else if(this.__defaults){this.__settings=SM.Object.deepCopy(this.__defaults)}}};SM.Widgets={register:function(e){e=SM.Object.extend(SM.Widget,e);if(!e.__NAME){throw new Error("the __NAME property must be defined")}e.__counter=0;this._extendjQuery(e);return e},extend:function(e,t){var i=SM.Object.extend(e,t);return this.register(i)},deepExtend:function(e,t){var i=SM.Object.deepExtend(e,t);return this.register(i)},create:function(e,t,i){var n=$.data(t,e.__NAME);if(!n){n=SM.Object.create(e);n.__initSettings(i);n.__uid=e.__counter++;if(e.__counter===1&&e.__setup){e.__setup()}n.el=t;n.$el=$(t);$.data(t,e.__NAME,n);if(i===undefined){i={}}if(e.__init){n.__init(i)}n.$el.on("remove",function(){n.destroy()})}return n},_extendjQuery:function(e){var t=this.create;if($.fn[e.__NAME]){throw new Error("class with this name already exists")}$.fn[e.__NAME]=function(i){function n(n,s){t(e,s,i)}return this.each(n)}}};if(typeof module=="object"&&module.exports){module.exports.Widget=SM.Widget;module.exports.Widgets=SM.Widgets}SM.Touch={TOUCH_BOUNDARY:5,TAP_DELAY:300,_touchCSSEnabled:false,isAndroid:false,init:function(e){this.touchStartCoordinates={x:null,y:null};e.addEventListener("touchstart",this.onTouchStart,false);e.addEventListener("touchend",this.onTouchEnd,false);this.enableTouchSensitiveCSS(e)},isTouchDevice:function(){var e=false;var t=/Chrome\/[.0-9]* Mobile/;if(navigator.userAgent.indexOf("Android")>0){e=/Galaxy Nexus|Nexus/.test(navigator.userAgent);if(t.test(navigator.userAgent)){e=true}}var i=/iP(ad|hone|od)/.test(navigator.userAgent);this.isAndroid=e;return i||e},touchHasMoved:function(e){var t=e.originalEvent.changedTouches[0],i=this.TOUCH_BOUNDARY,n=this.touchStartCoordinates.x,s=this.touchStartCoordinates.y;if(Math.abs(t.clientX-n)>i||Math.abs(t.clientY-s)>i){return true}return false},onTouchStart:function(e){var t=e.touches[0],i=SM.Touch;i.touchStartCoordinates={x:t.clientX,y:t.clientY}},onTouchEnd:function(e){var t=SM.Touch;t.touchStartCoordinates={x:null,y:null};t.lastClickTime=e.timeStamp},enableTouchSensitiveCSS:function(e){$(e).on("touchstart",".touch-sensitive",function(e){$(this).addClass("touchdown")}).on("touchmove",".touch-sensitive",function(e){if(SM.Touch.touchHasMoved(e)){var t=this;$(this).addClass("touchdown-animating-out");$(this).removeClass("touchdown");setTimeout(function(){$(t).removeClass("touchdown-animating-out")},250)}}).on("touchend",".touch-sensitive",function(e){var t=this;$(this).addClass("touchdown-animating-out");$(this).removeClass("touchdown");setTimeout(function(){$(t).removeClass("touchdown-animating-out")},250)});if(this.isAndroid){$(e).on("touchcancel",".touch-sensitive",function(e){var t=this;$(this).addClass("touchdown-animating-out");$(this).removeClass("touchdown");setTimeout(function(){$(t).removeClass("touchdown-animating-out")},250)})}}};SM.SliderQuestion=SM.Widgets.register({__NAME:"sliderQuestion",_POPOUT_LENGTH:253,_ZENKAKU:"\uff10\uff11\uff12\uff13\uff14\uff15\uff16\uff17\uff18\uff19",_INPUT_MAX_LEN:8,_CLEAR_BUTTON_WIDTH:50,_defaultSliderConfig:{min:0,max:100,step:1},__init:function(){this._parseElements()._parseConfiguration()._popoutCheck();if(!this._$sliderWidget.data("slider")){this._detectTextOverflow()._initWidget()._events()._syncResponseFromInput()}},_parseElements:function(){if(!this.$el.hasClass("slider-wrapper")){throw new Error("Slider question failed to initialize.")}this._$sliderWrapper=this.$el.find(".slider-question-wrapper");this._$sliderInput=this.$el.find("input");this._$sliderClear=this.$el.find(".slider-clear");this._$sliderWidget=this._$sliderWrapper.find("[data-slider]");this._$sliderKnob=this._$sliderWidget.find("a");this._$sliderValWarning=this.$el.siblings(".slider-warning");return this},_parseConfiguration:function(){this._min=parseInt(this._$sliderWidget.attr("data-slider-min"),10);this._max=parseInt(this._$sliderWidget.attr("data-slider-max"),10);this._initPos=parseInt(this._$sliderWidget.attr("data-slider-init"),10);this._stepSize=parseInt(this._$sliderWidget.attr("data-slider-step-size"),10);this._questionId=this.$el.closest("[data-question-id]").attr("data-question-id");return this},_popoutCheck:function(){if(this._questionId==="sample_s"){this.$el.parent().addClass("force-mobile");this._isPopout=true}return this},_initWidget:function(){var e=this._initPos!==this._min&&this._initPos!==this._max,t;if(this._isPopout){this._$sliderWidget.width(this._POPOUT_LENGTH);this._$sliderKnob.removeClass("has-response")}this._$sliderWidget.slider({options:{restrictStepSize:false,animateClick:true},constraints:{min:this._min,max:this._max,step:this._stepSize},value:this._initPos!==undefined?this._initPos:this._getMidValue(this._min,this._max)});if(e){t="50%"}else if(this._initPos===this._max){t="100%"}else{t="0"}this.$el.find(".slider-init-bar").css("left",t);this._reset(this);return this},_events:function(){var e=this,t=$("body").hasClass("ie9");this._inputEvent=t?"keyup":"input";this._namespacedResize="resize.slider_"+e._questionId;this._namespacedOrientationchange="orientationchange.slider_"+e._questionId;this.$el.on("slider.change",".slider-question",function(t){e._$sliderKnob.removeClass("dragging");e._handleInput(t,e)}).on("slider.start",".slider-question",function(t){e._$sliderKnob.addClass("has-response");e._handleInput(t,e)}).on("slider.stop",".slider-question",function(t){e._$sliderKnob.removeClass("dragging");e._handleInput(t,e)}).on("slider.slide",".slider-question",function(t){e._$sliderKnob.addClass("dragging");e._updateValue(t)});this._$sliderInput.on("blur",function(t){var i=$(t.target),n=i.val(),s=$.trim(n),a=e._$sliderWidget.data("slider").get("constraints"),o,r;i.val(s);s=e._truncateInput(s);i.val(s);s=e._zenkakuToHankaku(s);if(s===""){e._reset(e)}else if(e._isLegalInput(s)){s=parseInt(s,10);if(a.min<=s&&s<=a.max){r=e._stepSizeAdjustment(s);if(r!==s){s=r;e._adjustedVal=r;e._$sliderValWarning.fadeIn()}else{e._adjustedVal=undefined;e._$sliderValWarning.hide()}if(parseInt(e._$sliderWidget.data("slider").get("value"),10)===s){e._gotResponse(e)}e._$sliderWidget.data("slider").set("value",s);e._$sliderKnob.removeClass("dragging");if(e._adjustedVal!==undefined){i.val(e._adjustedVal)}else{i.val(n)}}else{e._reset(e)}e._$sliderClear.show()}else{e._reset(e);e._$sliderClear.show()}});this._$sliderClear.find("a").on("keypress",function(t){if(t.keyCode===13){e._reset(e,true)}}).on("click",function(){e._reset(e,true)});e._freeze();if(!e._isPopout){$(window).on(e._namespacedResize+","+e._namespacedOrientationchange,function(t,i){if(i&&i==="scroll"){return}var n=e.$el.closest("[data-question-id]").attr("data-question-id"),s=$(".survey-page-body").find("[data-question-id="+n+"]");if(s.length>0){e._updateSliderConfig(e)}else{e._freeze()}})}return this},_syncResponseFromInput:function(){var e=$.trim(this._$sliderInput.val());if(e){if(this._isLegalInput(e)&&this._min<=e&&this._max>=e){e=parseInt(e,10);this._$sliderWidget.data("slider").set("value",e);this._$sliderKnob.removeClass("dragging").addClass("has-response")}this._$sliderClear.show()}return this},_detectTextOverflow:function(){var e;this._$sliderClear.css("opacity",0).show();e=this._$sliderClear[0].scrollWidth;this._$sliderClear.hide().css("opacity",1);if(e>this._CLEAR_BUTTON_WIDTH){this.$el.addClass("slider-clear-overflow")}return this},_getMidValue:function(e,t){return Math.floor(e+(t-e)/2)},_handleInput:function(e,t){this._gotResponse(t);this._updateValue(e)},_updateValue:function(e){var t=$(e.target),i=t.find("a"),n=e.value,s=e.slider.get("value"),a=n!==undefined?n:s;if((n!==undefined||e.namespace==="start")&&i.hasClass("has-response")){t.closest(".slider-wrapper").find("input").val(a);i.attr("aria-valuenow",a)}},_updateSliderConfig:function(e){var t=e._$sliderKnob.hasClass("has-response"),i=e._$sliderWidget.data("slider").get("constraints");e._$sliderWidget.data("slider").set("constraints",i);if(!t){e._reset(e)}},_gotResponse:function(e){e._$sliderKnob.addClass("has-response");e._$sliderClear.show()},_onResponseCleared:function(e){e._$sliderKnob.removeClass("has-response");e._$sliderValWarning.hide();if($.trim(e._$sliderInput.val())===""){e._$sliderClear.hide()}},_reset:function(e,t){var i=e._$sliderWidget.data("slider").get("constraints"),n=e._$sliderInput.val();if(e._initPos>this._min&e._initPos<this._max){e._$sliderKnob.css("left",e._$sliderWidget.width()/2+"px")}else{e._$sliderWidget.data("slider").set("value",this._initPos)}if(t){e._$sliderInput.val("")}else{e._$sliderInput.val(n)}e._onResponseCleared(e);e._$sliderKnob.removeClass("has-response dragging")},_isLegalInput:function(e){return e.indexOf(".")===-1&&!isNaN(parseInt(e,10))},_freeze:function(){$(window).off(this._namespacedResize+" "+this._namespacedOrientationchange)},_stepSizeAdjustment:function(e){var t=(this._max-this._min)%this._stepSize,i=Math.ceil((this._max-this._min)/this._stepSize),n=Math.floor((e-this._min)/this._stepSize),s=Math.round((e-this._min)/this._stepSize),a=(e-this._min)%this._stepSize,o;if(a>0&&t!==0){if(n===i-1){if(a<t/2){s=n}else{s=i}}}if(s<i){o=s*this._stepSize+this._min}else{o=this._max}return o},_truncateInput:function(e){if(e.length>this._INPUT_MAX_LEN){return e.substr(0,this._INPUT_MAX_LEN)}return e},_zenkakuToHankaku:function(e){var t=e,i=0,n;for(i;i<this._ZENKAKU.length;i++){n=new RegExp(this._ZENKAKU[i],"g");t=t.replace(n,i+"")}return t},deactivate:function(){this._freeze();$(window).off(this._inputEvent);this._$sliderClear.find("a").off("keypress").off("click");this._$sliderWidget.removeData("slider")},get:function(e){if(e==="value"){return this._$sliderInput.val()}}});SM.CheckBox=SM.Widgets.register({__NAME:"checkbox",__init:function(){var e=this.$el.find("input[type=checkbox]");this.$el.on("focusin","input[type=checkbox]",{self:this},this._onFocusin).on("focusout","input[type=checkbox]",{self:this},this._onFocusout);if(SM.Touch.isTouchDevice()){this.$el.on("touchend","label",{self:this},this._onTouchEnd);this.$el.closest("td").on("touchend",{self:this},this._onTouchEnd);this.$el.on("click","input[type=checkbox]",{self:this},this._onClick);this.$el.on("changeOtherAnswerText","input[type=checkbox]",{self:this},this._onChange)}else{this.$el.on("change","input[type=checkbox]",{self:this},this._onChange)}this._setCheckedClass(e)},_onFocusin:function(e){var t=e.data.self,i=$(this),n=t._getLabel(i);n.addClass("focus")},_onFocusout:function(e){var t=e.data.self,i=$(this),n=t._getLabel(i);n.removeClass("focus")},_onChange:function(e){var t=e.data.self,i=$(this);t._setCheckedClass(i)},_onClick:function(e){e.preventDefault();e.stopPropagation();return false},_onTouchEnd:function(e){var t=e.data.self,i=t.$el.find("input[type=checkbox]"),n=t._getLabel(i),s=n.hasClass("checked");if(e.isDefaultPrevented()||typeof n.closest("[data-preset-question]")[0]!=="undefined"){return}e.preventDefault();if(!SM.Touch.touchHasMoved(e)){i.prop("checked",!s);t._setCheckedClass(i)}},_getLabel:function(e){var t=e.attr("id");return this.$el.find("[for="+t+"]")},_setCheckedClass:function(e){var t=this._getLabel(e);if(e.prop("checked")){t.addClass("checked")}else{t.removeClass("checked")}}});SM.RadioButtonGroup=SM.Widgets.register({__NAME:"radioButtonGroup",__init:function(){var e=this;this.$el.on("focusin","input[type=radio]",{self:this},this._onFocusin).on("focusout","input[type=radio]",{self:this},this._onFocusout).on("change","input[type=radio]",{self:this},this._onChange);if(SM.Touch.isTouchDevice()){this.$el.on("touchend","td:has(label), label",{self:this},this._onTouchEnd)}else{this.$el.on("click","label[data-sm-radio-button-label].checked",{self:this},this._onClick).on("click","td:has(label)",{self:this},this._onCellClick)}this._setCheckedClass()},_onFocusin:function(e){var t=e.data.self,i=$(this),n=t._getLabel(i);n.addClass("focus")},_onFocusout:function(e){var t=e.data.self,i=$(this),n=t._getLabel(i);n.removeClass("focus")},_onChange:function(e){var t=e.data.self;t._setCheckedClass();$naRadio=t.$el.find("[data-emoji-na-button] .radio-button-input");if($naRadio.length==1&&$(e.target).is($naRadio)){$currentQuestion=$naRadio.closest(".question-emoji-rating-table");if($currentQuestion.length){$currentQuestion.find(".emoji-rating").removeClass("selected").removeClass("hovered");$currentQuestion.find(".emoji-rating input[type=radio]").prop("checked",false).data("selected",false)}}},_onTouchEnd:function(e){var t=$(this).closest("[data-sm-radio-button]");if(e.isDefaultPrevented()||typeof t.closest("[data-preset-question]")[0]!=="undefined"){return}e.preventDefault();if(!t.length){t=$(this).find("[data-sm-radio-button]")}var i=e.data.self,n=t.find("input[type=radio]"),s=i._getLabel(n),a=i.$el.find(".checked");if(!SM.Touch.touchHasMoved(e)){if(a.length){a.find("input[type=radio]").prop("checked",false)}n.prop("checked",!s.hasClass("checked"));n.trigger("change")}},_onCellClick:function(e){if($(e.target).is("td")){$(this).find("label").click()}},_onClick:function(e){var t=e.data.self,i=$(this),n=i.attr("for"),s=$("#"+n);if(s.prop("checked")&&typeof s.closest("[data-preset-question]")[0]==="undefined"){s.prop("checked",false);s.trigger("change");e.preventDefault()}},_getLabel:function(e){var t=e.attr("id");return this.$el.find("[for="+t+"]")},_setCheckedClass:function(){var e=this,t;this.$el.find("input[type=radio]").each(function(i,n){var s=$(this),a=e._getLabel(s);a.removeClass("checked");if(s.prop("checked")){a.addClass("checked");t=s}});if(SM.Touch.isTouchDevice()){this.$el.trigger({type:"radiobuttonchanged",$selected:t})}}});SM.OtherAnswerTextOption=SM.Widgets.register({__NAME:"otherAnswerTextOption",__init:function(e){e=typeof e==="string"?e:"question";var t=this.$el.parents("."+e),i=t.find("[data-other-answer]");if(i.length){this._$answer=i;this._answerTag=i.prop("tagName").toLowerCase();if(this._answerTag==="option"){t.find("select").on("change",{self:this},this._onSelectChange);this._toggleVisibility()}else{i.on("change",{self:this},this._onOtherInputChange)}this.$el.on("keyup paste",{self:this},this._onEdit).on("click touchend",{self:this},this._onClickOrTouch)}},_onEdit:function(e){var t=e.data.self,i=$.trim(t.$el.val());if(!i){return}if(e.type==="keyup"&&e.which===SM.KeyCodes.TAB||e.which===SM.KeyCodes.SHIFT){return}if(t._answerTag==="option"){if(!t._$answer.prop("selected")){t._$answer.prop("selected",true)}}else{if(!t._$answer.prop("checked")){t._$answer.prop("checked",true);t._$answer.trigger("change");t._$answer.trigger("changeOtherAnswerText")}}},_toggleVisibility:function(){var e=!!this._$answer.prop("selected");this.$el.toggle(e);return e},_onSelectChange:function(e){var t=e.data.self;var i=t._toggleVisibility();if(i){t.$el.focus()}},_onOtherInputChange:function(e){var t=e.data.self;if(t._$answer.prop("checked")){t.$el.focus()}},_onClickOrTouch:function(e){var t=e.data.self;if(t._answerTag==="option"){if(!t._$answer.prop("selected")){t._$answer.prop("selected",true)}}else{if(!t._$answer.prop("checked")){t._$answer.prop("checked",true);t._$answer.trigger("change");t._$answer.trigger("changeOtherAnswerText")}}}});SM.ForcedRankingQuestion=SM.Widgets.register({__NAME:"forcedRankingQuestion",__init:function(){this.$el.on("change","input[type=radio]",{self:this},this._onRadioChange)},_onRadioChange:function(e){var t=e.data.self,i,n,s,a,o;i=$(this);if(!i.prop("checked")){return}a=t.$el.find("table tbody tr");n=i.parents("tr");s=n.find("input[type=radio]");o=s.index(i);a.not(n).each(function(){var e=$(this),t=e.find("input[type=radio]"),i=t.eq(o);if(i.prop("checked")){i.prop("checked",false);i.trigger("change")}})}});SM.NpsQuestion=SM.Widgets.register({__NAME:"npsQuestion",NPS_CONTAINER_OFFSET_TOP:7,NPS_CONTAINER_OFFSET_LEFT:8,NPS_POP_UP_PADDING:20,__init:function(){var e=this;if(SM.Touch.isTouchDevice()){this.$el.on("touchstart","label",{self:this},this._onTouchStart).on("touchend","label",{self:this},this._onTouchEnd).on("radiobuttonchanged",{self:this},this._setNpsPressedState)}},_onTouchStart:function(e){var t=e.data.self,i=$(this),n=i.closest(".nps-radio-button-container"),s=n.parents("div.question-matrix-nps-table").find(".nps-pop-up");s.css({width:n.outerWidth()+t.NPS_POP_UP_PADDING,height:n.outerHeight()+t.NPS_POP_UP_PADDING});s.show();s.find(".nps-pop-up-text").text(n.find(".radio-button-display").attr("data-position"));s.offset({top:n.offset().top-t.NPS_CONTAINER_OFFSET_TOP,left:n.offset().left-t.NPS_CONTAINER_OFFSET_LEFT})},_onTouchEnd:function(e){var t=e.data.self,i=$(this).closest(".nps-radio-button-container"),n=i.parents("div.question-matrix-nps-table").find(".nps-pop-up");n.hide()},_setNpsPressedState:function(e){var t=e.data.self;t.$el.find(".nps-radio-button-container").removeClass("nps-pressed-state");if(e.$selected){e.$selected.closest(".nps-radio-button-container").addClass("nps-pressed-state")}}});SM.RankingQuestion=SM.Widgets.register({__NAME:"rankingQuestion",NA_CLASS:"question-ranking-na-rank",NA_LABEL_CLASS:"answer-label-rank-na",NA_LABEL_SELECTOR:".answer-label-rank-na",CHECKBOX_SELECTOR:"input[type=checkbox]",SORTING_CLASS:"question-ranking-sorting",SORTING_PLACEHOLDER_CLASS:"question-ranking-sort-placeholder",SORTING_PLACEHOLDER_SELECTOR:".question-ranking-sort-placeholder",DISABLED_SORTABLE_CLASS:"disable-sortable",DISABLED_SORTABLE_HANDLE_CLASS:"disable-sortable-handle",HANDLE_HOVER_CLASS:"question-ranking-rank-hover",SORTABLE_SELECTOR:".question-ranking-rank-wrapper",DISABLED_SORTABLE_SELECTOR:".disable-sortable",ENABLED_SORTABLE_SELECTOR:".question-ranking-rank-wrapper:not(.disable-sortable)",HANDLE_SELECTOR:".question-ranking-rank",SORTABLES_CONTAINER_SELECTOR:".question-ranking-sortable-container",__init:function(){this._$rankContainer=this.$el.find(this.SORTABLES_CONTAINER_SELECTOR);this._buildRankValueMaps();this._initRankState();this._sortRankElements();this._updateEnabledOptions();this.$el.on("mouseenter",this.HANDLE_SELECTOR,{self:this},this._onMouseenter).on("mouseleave",this.HANDLE_SELECTOR,{self:this},this._onMouseleave).on("mousedown",this.ENABLED_SORTABLE_SELECTOR,{self:this},this._onMousedown).on("change",this.CHECKBOX_SELECTOR,{self:this},this._onNaCheckboxChange).on("change","select",{self:this},this._onSelectChange)},_buildRankValueMaps:function(){var e=this,t={},i={},n=this.$el.find("select").first();n.find("option").each(function(){var e=$(this),n,s=$.trim(e.text()),a;if(s.length){a=parseInt(s,10);if(isNaN(a)){a="na"}n=e.attr("value");t[a]=n;i[n]=a}});this._rankToValue=t;this._valueToRank=i},_initRankState:function(){var e=this,t=this.$el.find(this.SORTABLE_SELECTOR);t.each(function(t,i){var n=$(i),s=n.find("select"),a=n.find(e.CHECKBOX_SELECTOR),o,r;e._syncSelectValue(s);o=s.val();r=o===e._rankToValue["na"];a.prop("checked",r);e._updateNAClasses(n,r)})},_sortRankElements:function(){var e=this._buildRankLists(),t=this._sortRankLists(e);this._$rankContainer.append(t)},_buildRankLists:function(){var e=this.$el.find(this.SORTABLE_SELECTOR),t=[],i=[],n=[],s=this;e.each(function(e,a){var o=$(a),r=o.find("select"),l,u;l=r.val();u=l===s._rankToValue["na"];o=o.detach();if(u){t.push(o)}else if(l){i.push(o)}else{n.push(o)}});return{naRows:t,rankedRows:i,unrankedRows:n,allRows:e.get()}},_sortRankLists:function(e){var t,i=this;if(!e.rankedRows.length){t=e.unrankedRows}else if(!e.unrankedRows.length){t=e.rankedRows.sort(function(e,t){var n=i._valueToRank[e.find("select").val()],s=i._valueToRank[t.find("select").val()];return n-s})}else{t=i._sortRankedAndUnrankedRows(e)}if(e.naRows.length){t=t.concat(e.naRows)}return t},_sortRankedAndUnrankedRows:function(e){var t=e.allRows.length-e.naRows.length,i,n,s,a=[];for(s=0;s<t;s++){i=s+1;n=this._getRowElByRank(e,i);if(n){a.push(n)}else{a.push(e.unrankedRows.shift())}}return a},_getRowElByRank:function(e,t){var i=e.rankedRows.length,n,s,a;for(a=0;a<i;a++){n=e.rankedRows[a];s=this._valueToRank[n.find("select").val()];if(s===t){return n}}},_onSelectChange:function(e){var t=e.data.self,i=$(this),n=i.parents(t.SORTABLE_SELECTOR),s=n.find(t.CHECKBOX_SELECTOR),a=t.$el.find("select").not(i),o,r,l,u=i.val(),d=t._valueToRank[u],h=i.attr("data-row-id"),f=t._getRankValueEl(h).val(),c=t._valueToRank[f],_=t._rankToValue["na"],p=u===_,g=e.cascade;s.prop("checked",p);t._updateNAClasses(n,p);t._updateEnabledOptions();if(u&&!p){o=t._findOtherSelectWithValue(i);if(o){if(f===_||!f){l=t._getUnnassignedRanks();g="up";$.each(l,function(e){if(e>d){g="down";return false}})}if(t._dragOffset!==undefined){if(g==="down"){r=t._rankToValue[d+1]}else if(g==="up"){r=t._rankToValue[d-1]}else if(c<d){r=t._rankToValue[d-1];g="up"}else if(c>d){r=t._rankToValue[d+1];g="down"}o.val(r).trigger({type:"change",cascade:g})}else{r=t._rankToValue[c];
o.val("").trigger("change")}}}else if(p){a.each(function(e,i){var n=$(i),s=n.val(),a,o;if(s&&s!==_){o=t._valueToRank[s];if(c<o){a=t._rankToValue[o-1];n.val(a);t._syncHiddenValue(n)}}else if(s===null){a=t._rankToValue[t._lowestRank];n.val(a);t._syncHiddenValue(n)}})}t._syncHiddenValue(i)},_onNaCheckboxChange:function(e){var t=e.data.self,i=$(this),n=i.is(":checked"),s=i.parents(t.SORTABLE_SELECTOR),a=s.find("select");if(n){a.val(t._rankToValue["na"]).trigger("change")}else{t._rankPosition(s)}t._sortRankElements();t._rankPositions()},_onMouseenter:function(e){var t=e.data.self;$(this).addClass(t.HANDLE_HOVER_CLASS)},_onMouseleave:function(e){var t=e.data.self;$(this).removeClass(t.HANDLE_HOVER_CLASS)},_getAssignedRanks:function(){var e=this,t={};this.$el.find("select").each(function(i,n){var s=$(n),a=s.val(),o=e._valueToRank[a];if(o&&o!=="na"){t[o]=true}});return t},_getUnnassignedRanks:function(){var e={},t=this,i=this._getAssignedRanks();$.each(this._rankToValue,function(n){if(!i[n]&&n!=="na"&&n<=t._lowestRank){e[n]=true}});return e},_findOtherSelectWithValue:function(e){var t=e.val(),i;this.$el.find("select").not(e).each(function(e,n){if($(n).val()===t){i=$(n);return false}});return i},_updateNAClasses:function(e,t){var i=e.find(this.HANDLE_SELECTOR);if(t){i.addClass(this.DISABLED_SORTABLE_HANDLE_CLASS).addClass(this.NA_CLASS);e.addClass(this.DISABLED_SORTABLE_CLASS)}else{i.removeClass(this.DISABLED_SORTABLE_HANDLE_CLASS).removeClass(this.NA_CLASS);e.removeClass(this.DISABLED_SORTABLE_CLASS)}},_updateEnabledOptions:function(){var e=this.$el.find(this.DISABLED_SORTABLE_SELECTOR).length,t,i=this;this.$el.find(this.SORTABLE_SELECTOR).each(function(){var t=$(this),n=t.find("select"),s=t.find(i.CHECKBOX_SELECTOR),a,o=s.prop("checked"),r,l=n.children("option");l.prop("disabled",false);a=-1-e;if(o){a++}l.slice(a,-1).prop("disabled",true)});this._setLowestRank()},_setLowestRank:function(){var e=this,t=this.$el.find(this.ENABLED_SORTABLE_SELECTOR).first(),i,n;n=t.find("option").filter(function(t){var i=$(this),n=i.attr("value"),s=e._valueToRank[n];return!i.prop("disabled")&&s!=="na"}).last();i=this._valueToRank[n.attr("value")];e._lowestRank=i},_syncHiddenValue:function(e){var t=e.attr("data-row-id");this._getRankValueEl(t).val(e.val())},_syncSelectValue:function(e){var t=e.attr("data-row-id");e.val(this._getRankValueEl(t).val())},_getRankValueEl:function(e){return this.$el.find("input[data-row-id="+e+"]")},_onMousedown:function(e){var t=$(this),i=$(e.target),n=e.data.self,s=e.pageY-t.offset().top,a=n.$el.find(n.ENABLED_SORTABLE_SELECTOR);if(i.is("select")||i.is("option")||i.hasClass(n.NA_LABEL_CLASS)||i.parents(n.NA_LABEL_SELECTOR).length){return}n._setupDrag(t,s);e.preventDefault()},_onGlobalMousemove:function(e){var t=e.data.rankingQuestion,i=e.data.$rank,n;if(!t._isSorting){t._startSort(i)}n=t._moveRank(i,e.pageY);if(n!==undefined&&t._placeholderIndex!==n){t._movePlaceholder(n)}},_onGlobalMouseup:function(e){var t=e.data.rankingQuestion,i=e.data.$rank;if(t._isSorting){t._stopSort(i)}t._teardownDrag()},_setupDrag:function(e,t){this.ondragstart=function(){return false};document.onselectstart=function(){return false};this.subscribe("mousemove",this._onGlobalMousemove,{$rank:e}).subscribe("mouseup",this._onGlobalMouseup,{$rank:e});this._dragOffset=t},_startSort:function(e){var t;this._isSorting=true;this._sortRankElements();t=e.clone();t.addClass(this.SORTING_PLACEHOLDER_CLASS);t.insertAfter(e);this._$rankContainer.prepend(e);e.addClass(this.SORTING_CLASS);this._buildRankTops();this._placeholderIndex=t.index();this.trigger("startSort")},_moveRank:function(e,t){var i=this._$rankContainer.offset().top,n=this._$rankContainer.outerHeight(),s=n+i,a=t-this._dragOffset-i,o=e.outerHeight(),r=o+a;if(r>n){e.css("top",n-o)}else if(a<0){e.css("top",0)}else{e.css("top",a)}return this._rankTops[Math.ceil(a)]},_stopSort:function(e){var t=this;this._isSorting=false;e.removeClass(this.SORTING_CLASS);e.css("top","auto");this.$el.find(this.SORTING_PLACEHOLDER_SELECTOR).replaceWith(e);this._rankPosition(e);this._sortRankElements();t._rankPositions();this.trigger("stopSort")},_teardownDrag:function(){this.unsubscribe("mousemove").unsubscribe("mouseup");document.onselectstart=null;delete this._dragOffset},_buildRankTops:function(){var e=this.$el.find(this.ENABLED_SORTABLE_SELECTOR),t={};e.each(function(e,i){var n=$(i),s,a=n.position().top;if(e!==0){for(s=a-2;s<=a+2;s++){t[Math.ceil(s)]=e}}});this._rankTops=t},_movePlaceholder:function(e){var t=this._$rankContainer,i=t.children(),n=this._placeholderIndex,s=i.eq(n),a=i.eq(e);if(n<e){a.after(s)}else if(n>e){a.before(s)}this._buildRankTops();this._placeholderIndex=e},_rankPosition:function(e){var t=e.index(),i=t+1,n=this._rankToValue[i],s=e.find("select");s.val(n).trigger("change")},_rankPositions:function(){var e=this,t=this.$el.find(this.SORTABLE_SELECTOR);t.each(function(t,i){var n=$(i),s=n.find("select"),a=s.val(),o=e._rankToValue[t+1];if(a!==e._rankToValue["na"]){s.val(o);e._syncHiddenValue(s)}})}});SM.SurveyPageForm=SM.Widgets.register({__NAME:"surveyPageForm",__resizeTimeout:null,__init:function(){var e=this;this.$el.on("submit",{self:this},this._onSubmit).on("click",".survey-submit-actions button",{self:this},this._onSubmitClick).on("keydown","input, select",{self:this},this._onKeydownAny).on("keydown","input[type=radio]",{self:this},this._onKeydownRadio).on("keyup","input[type=radio]",{self:this},this._onKeyupRadio);$(window).on("unload",{self:this},this._onWindowUnload).on("pagehide",{self:this},this._onWindowUnload).on("load",function(){e.applyOverflowClasses();e.removeNoTouchClasses()}).on("orientationchange resize",function(){var t=function(){e.applyOverflowClasses.apply(e)};clearTimeout(e.__resizeTimeout);e.__resizeTimeout=setTimeout(t,100)});if($(".question-fileupload").length>0){$(window).on("beforeunload",{self:this},this._onWindowBeforeUnloadFileUpload)}},applyOverflowClasses:function(){this.$el.find(".question-body").each(function(){if(this.scrollWidth>this.offsetWidth+50){$(this).addClass("question-overflow")}})},removeNoTouchClasses:function(){if(SM.Touch.isTouchDevice()){$(this.$el.find(".no-touch")).removeClass("no-touch")}},_onKeydownAny:function(e){var t=e.data.self,i=$(this).attr("type"),n=e.which===SM.KeyCodes.ENTER||e.which===SM.KeyCodes.NUMPAD_ENTER;if(n){e.preventDefault();if(i==="radio"||i==="checkbox"){t._toggle(this)}}},_onKeydownRadio:function(e){var t=e.data.self,i=e.which===SM.KeyCodes.SPACE;if(i){e.preventDefault();t._toggle(this)}},_onKeyupRadio:function(e){var t=e.data.self,i=e.which===SM.KeyCodes.SPACE;if(i){e.preventDefault()}},_onSubmit:function(e){var t=e.data.self;if(t.get("isSubmitting")){e.stopPropagation();e.preventDefault()}else{t.set("isSubmitting",true)}},_onSubmitClick:function(e){var t=e.data.self;if(!t.get("isSubmitting")){if($(["data-preset-question"])&&$(":disabled")){$(":disabled").removeAttr("disabled")}$(this).addClass("submitting")}},_onWindowBeforeUnloadFileUpload:function(e){var t=e.data.self,i=$(".upload-status.sm-spin");if(i.length>0){$(".survey-submit-actions button").removeClass("submitting");t.set("isSubmitting",false)}},_onWindowUnload:function(e){var t=e.data.self;t.set("isSubmitting",false)},_toggle:function(e){var t=$(e);t.prop("checked",!t.prop("checked")).trigger("change")}});SM.Slider=SM.Widgets.register({__NAME:"slider",__init:function(){this._cacheElements()._setLayoutData()._setValues()._bindEvents()},__defaults:{constraints:{min:0,max:100,step:1},value:0,rangeMin:0,rangeMax:100,options:{restrictStepSize:true,animateClick:false}},__setters:{constraints:function(e,t){e._setConstraints(t)},rangeMin:function(e,t){if(!e._isRange){return}e._setRangeMinView(t)._setRangeMin(t)},rangeMax:function(e,t){if(!e._isRange){return}e._setRangeMaxView(t)._setRangeMax(t)},value:function(e,t){if(e._isRange){return}e._setValueView(t)._setValue(t)},restrictStepSize:function(e,t){if(typeof t!=="boolean"){return}e._setStepSizeRestriction(t)}},_setConstraints:function(e){SM.Object.update(this.__settings.constraints,e);this._setLayoutData()._setValues().__trigger("constraintChange");return this},_setValue:function(e){var t=this.__settings,i=t.constraints;e=this._constrainValue(i.min,i.max,e);if(t.value===e){return this}t.value=e;this.__trigger("change");return this},_setRangeMax:function(e){var t=this.__settings,i=t.constraints;e=this._constrainValue(t.rangeMin+i.step,i.max,e);if(t.rangeMax===e){return this}t.rangeMax=e;this.__trigger("change");return this},_setRangeMin:function(e){var t=this.__settings,i=t.constraints;e=this._constrainValue(i.min,t.rangeMax-i.step,e);if(t.rangeMin===e){return this}t.rangeMin=e;this.__trigger("change");return this},_setStepSizeRestriction:function(e){var t=this.__settings,i=t.options.restrictStepSize;if(!i&&e&&!this._stepSizeDividePerfectly()){throw new Error("Cannot restrict the step size of a slider that previously allowed and                 had a step size that didn't divide max - min")}t.options.restrictStepSize=e;return this},_stepSizeDividePerfectly:function(){var e=this.__settings.constraints,t=e.max-e.min;return t%e.step===0},_setValueView:function(e,t){var i,n,s=this.__settings,a=s.constraints;e=this._constrainValue(a.min,a.max,e);i=this._valueToHandlePosition(e);n=parseInt(this._$handle.css("left"),10);if(this._handleLabel){this._$label.text(e)}if(!t){this.__trigger({type:"slide",value:e,$label:this._$label})}else{this.__trigger({type:"start",value:e,$label:this._$label})}if(!s.options.animateClick||!t){this._$handle.css("left",i)}else{this._$handle.stop().animate({left:i},300)}if(this._handleLabel){this._positionLabel(this._$label,this._$handle)}return this},_setRangeMaxView:function(e){var t,i=this.__settings,n,s=i.constraints;e=this._constrainValue(i.rangeMin+s.step,s.max,e);t=this._valueToHandlePosition(e);n=parseInt(this._$maxHandle.css("left"),10);this._$maxHandle.css("left",t);if(this._handleLabel){this._$maxLabel.text(e)}this.__trigger({type:"slide",value:e,$label:this._$maxLabel});if(this._handleLabel){this._positionLabel(this._$maxLabel,this._$maxHandle)}this._adjustMaxEnd(t);return this},_setRangeMinView:function(e){var t,i=this.__settings,n,s=i.constraints;e=this._constrainValue(s.min,i.rangeMax-s.step,e);t=this._valueToHandlePosition(e);n=parseInt(this._$minHandle.css("left"),10);this._$minHandle.css("left",t);if(this._handleLabel){this._$minLabel.text(e)}this.__trigger({type:"slide",value:e,$label:this._$minLabel});if(this._handleLabel){this._positionLabel(this._$minLabel,this._$minHandle)}this._adjustMinEnd(t);return this},_cacheElements:function(){this._$handle=this.$el.find("a");if(this._$handle.length>1){this._$minHandle=this._$handle.eq(0);this._$maxHandle=this._$handle.eq(1);this._$range=this.$el.find("div");this._isRange=true}this._$label=this.$el.find("span.slider-label");this._handleLabel=this._$label.length>0;if(this._$label.length>1){this._$minLabel=this._$label.eq(0);this._$maxLabel=this._$label.eq(1)}return this},_setLayoutData:function(){var e=this.__settings.constraints,t;t=e.max-e.min;if(this.__settings.options.restrictStepSize&&!this._stepSizeDividePerfectly()){throw new Error("your min - max must be divisible by your step")}this._width=this.$el.outerWidth();this._stepPixelDistance=this._width/t*e.step;return this},_setValues:function(){var e=this.__settings,t,i=e.constraints;if(!this._isRange){this._setValueView(e.value)._setValue(e.value).__trigger("change")}else{this._setRangeMinView(e.rangeMin)._setRangeMin(e.rangeMin)._setRangeMaxView(e.rangeMax)._setRangeMax(e.rangeMax).__trigger("change")}return this},_bindEvents:function(){if(this._isRange){this.$el.on("click",{slider:this},this._onRangeClick);this._$minHandle.on("mousedown",{slider:this,setter:"_setRangeMin"},this._onHandleMouseDown).on("touchstart",{slider:this,setter:"_setRangeMin"},this._onHandleMouseDown).on("keydown",{slider:this,viewSetter:"_setRangeMinView"},this._onHandleKeyDown).on("keyup",{slider:this,setter:"_setRangeMin"},this._onHandleKeyUp).on("click",this._onHandleClick);this._$maxHandle.on("mousedown",{slider:this,setter:"_setRangeMax"},this._onHandleMouseDown).on("touchstart",{slider:this,setter:"_setRangeMax"},this._onHandleMouseDown).on("keydown",{slider:this,viewSetter:"_setRangeMaxView"},this._onHandleKeyDown).on("keyup",{slider:this,setter:"_setRangeMax"},this._onHandleKeyUp).on("click",{slider:this},this._onHandleClick)}else{this.$el.on("click",{slider:this},this._onClick);this._$handle.on("mousedown",{slider:this,setter:"_setValue"},this._onHandleMouseDown).on("touchstart",{slider:this,setter:"_setValue"},this._onHandleMouseDown).on("keydown",{slider:this,viewSetter:"_setValueView"},this._onHandleKeyDown).on("keyup",{slider:this,setter:"_setValue"},this._onHandleKeyUp).on("click",{slider:this},this._onHandleClick)}if(this._handleLabel){$(window).on("resize."+this.__NAME+this.__uid,{slider:this},this._onGlobalResize)}return this},_valueToHandlePosition:function(e){var t=this.__settings.constraints,i=Math.ceil(this._width/this._stepPixelDistance),n=e-t.min,s=Math.round(n/t.step),a=e===t.max?this._width:s*this._stepPixelDistance;return a},_handlePositionToValue:function(e){var t=this.__settings.constraints,i=Math.ceil(this._width/this._stepPixelDistance),n=Math.round(e/this._stepPixelDistance),s=n*t.step,a=s+t.min,o=this._width-this._stepPixelDistance*(i-1),r=e-this._stepPixelDistance*(i-1);if(Math.ceil(e/this._stepPixelDistance)===i&&r>o/2){return t.max}return a},_adjustMinEnd:function(e){this._$range.css("left",e)},_adjustMaxEnd:function(e){this._$range.css("right",this._width-e)},_constrainValue:function(e,t,i){if(i>t){i=t}else if(i<e){i=e}return i},_positionLabel:function(e,t){var i=parseInt(t.css("left"),10),n=t.outerWidth(),s,a=e.outerWidth();if(!e.is(":visible")){a=e.appendTo(document.body).outerWidth();e.appendTo(this.$el)}s=i-(a-n)/2;e.css("left",s);return this},_onClick:function(e){var t=e.data.slider,i=e.pageX-t.$el.offset().left,n=t._handlePositionToValue(i);t._setValueView(n,true);t._setValue(n);t.__trigger("change")},_onRangeClick:function(e){var t=e.data.slider,i=e.pageX-t.$el.offset().left,n=t._handlePositionToValue(i),s=Math.abs(n-t.__settings.rangeMax),a=Math.abs(n-t.__settings.rangeMin);if(s<=a){t._setRangeMaxView(n);t._setRangeMax(n)}else{t._setRangeMinView(n);t._setRangeMin(n)}},_onHandleKeyDown:function(e){var t=$(this),i=e.data.slider,n=i.__settings.constraints,s=e.data.viewSetter,a=e.which,o=i._handlePositionToValue(parseInt(t.css("left"),10));if(!a){return}if(a===SM.KeyCodes.LEFT){i.__trigger("start");i[s](o-n.step)}else if(a===SM.KeyCodes.RIGHT){i.__trigger("start");i[s](o+n.step)}},_onHandleKeyUp:function(e){var t=$(this),i=e.data.slider,n=e.data.setter,s=e.which,a=i._handlePositionToValue(parseInt(t.css("left"),10));if(!s){return}if(s===SM.KeyCodes.LEFT){i[n](a)}else if(s===SM.KeyCodes.RIGHT){i[n](a)}},_onHandleClick:function(e){e.preventDefault()},_onHandleMouseDown:function(e){var t=$(this),i=e.data.setter+"View",n=e.data.slider;this.ondragstart=function(){return false};document.onselectstart=function(){return false};t.focus();n.__trigger("start").__subscribe("touchend",n._onGlobalMouseup,{valueSetter:e.data.setter}).__subscribe("touchmove",n._onGlobalMousemove,{viewSetter:i}).__subscribe("mouseup",n._onGlobalMouseup,{valueSetter:e.data.setter}).__subscribe("mousemove",n._onGlobalMousemove,{viewSetter:i});e.preventDefault()},_onGlobalMouseup:function(e){var t=e.data.slider,i=e.type==="touchend"?parseInt($(e.target).css("left").replace("px","")):e.pageX,n=e.type==="touchend"?i:i-t.$el.offset().left,s=e.data.valueSetter,a=t._handlePositionToValue(n);t.__unsubscribe("touchmove").__unsubscribe("touchend").__unsubscribe("mousemove").__unsubscribe("mouseup");document.onselectstart=null;t[s](a,true);t.__trigger("stop")},_onGlobalMousemove:function(e){var t=e.data.slider,i=e.data.viewSetter,n=e.type==="touchmove"?e.originalEvent.touches[0].pageX:e.pageX,s=n-t.$el.offset().left,a=t._handlePositionToValue(s);t[i](a)},_onGlobalResize:function(e){var t=e.data.slider;if(t._isRange){t._positionLabel(t._$minLabel,t._$minHandle);t._positionLabel(t._$maxLabel,t._$maxHandle)}else{t._positionLabel(t._$label,t._$handle)}}});SM.EmojiRatingQuestion=SM.Widgets.register({__NAME:"emojiRatingQuestion",__init:function(){var e=this;this._radioMouseClicked=false;this.$el.on("change","input[type=radio]",{self:this},this._onChange).on("click",".emoji-rating",{self:this},this._onClick).on("mouseenter",".emoji-color, .emoji-button-input, .emoji-border",{self:this},this._onMouseEnter).on("mouseleave",".emoji-color, .emoji-button-input, .emoji-border",{self:this},this._onMouseLeave).on("mouseup","input[type=radio]",{self:this},this._onMouseUp).on("focusin","input[type=radio]",{self:this},this._onFocusin).on("focusout","input[type=radio]",{self:this},this._onFocusout);this._refreshEmojiState()},_onMouseEnter:function(e){var t=e.data.self,i=t.$el.closest(".question-emoji-rating-table"),n=t.$el.find(".emoji-rating"),s=i.find(".emoji-rating");s.each(function(e,t){$(t).addClass("selected");$(t).find(".emoji-border").addClass("hovered");if(n.is($(t)))return false})},_onMouseLeave:function(e){var t=e.data.self,i=t.$el.closest(".question-emoji-rating-table"),n=t.$el.find(".emoji-rating"),s=i.find("[data-sm-emoji-button]");s.each(function(e,t){var i=$(t).find("input:checked");if(i.length!=1){$(t).find(".emoji-rating").removeClass("selected");$(t).find(".emoji-border").removeClass("hovered")}if(n.is($(t)))return false});t._refreshEmojiState()},_onMouseUp:function(e){var t=e.data.self,i=t.$el.closest("[data-sm-emoji-button]"),n=i.find(".emoji-border");n.removeClass("focus");t._radioMouseClicked=true},_onFocusin:function(e){var t=e.data.self,i=t.$el.closest("[data-sm-emoji-button]"),n=i.find(".emoji-border");n.addClass("focus")},_onFocusout:function(e){var t=e.data.self,i=t.$el.closest("[data-sm-emoji-button]"),n=i.find(".emoji-border");n.removeClass("focus")},_onChange:function(e){var t=e.data.self,i=t.$el.find("input[type=radio]");t._radioMouseClicked=false;t._refreshEmojiState()},_onClick:function(e){var t=e.data.self,i=t.$el.find("input[type=radio]");if(!$(e.target).is(i)){i.prop("checked",!i.prop("checked"));i.trigger("change")}else if(t._radioMouseClicked&&i.data("selected")){i.prop("checked",false);i.trigger("change")}},_refreshEmojiState:function(){var e=this,t=e.$el.closest(".question-emoji-rating-table"),i=t.find("[data-sm-emoji-button]"),n=i.find("input:checked");i.find(".emoji-rating").removeClass("selected");i.find(".emoji-border").removeClass("hovered");i.find("input[type=radio]").data("selected",false);if(n.length==1){i.each(function(e,t){$(t).find(".emoji-rating").addClass("selected");var i=$(t).find("input:checked");if(i.length==1){if(!i.data("selected"))i.data("selected",true);return false}})}}});SM.FacebokShareButton=SM.Widgets.register({__NAME:"fbShareBtn",__init:function(){this.$el.on("click",{self:this},this._onClick)},_onClick:function(e){e.preventDefault();var t=e.data.self;t._fbShareBtn(t.$el.attr("data-facebook-app-id"),"",t.$el.attr("data-survey-title"),t.$el.attr("data-redirect-url"))},_getQueryVariable:function(e){var t=window.location.search.substring(1);var i=t.split("&");for(var n=0;n<i.length;n++){var s=i[n].split("=");if(decodeURIComponent(s[0])===e){return decodeURIComponent(s[1])}}},_fbShareBtn:function(e,t,i,n){var s="http://www.facebook.com/dialog/feed?app_id="+e+"&show_error=true&",a=this._getQueryVariable("na")==="new_auth"?"user/auth/":"closepop.aspx";if(t===""){s+="link="+encodeURI(location.href)+"&"}else{s+="link="+encodeURI("http://facebook.com/pages/SM-Survey-View/"+t+"?sk=app_"+e)+"&";s+="caption= &"}s+="name="+i+"&";s+="description="+window.escape('Please take the survey titled "'+i+'". Your feedback is important!')+"&";s+="picture="+$('link[rel="image_src"]').attr("href")+"&";s+="redirect_uri=http://"+n+"/"+a+"?close=true";var o=window.open(s,"_blank","width=700,height=580,scrollbars=yes");o.focus()}});$(function(){var e="survey_file_uploader",t=$("[data-question-fileupload]");function i(){var e=$("body"),t=$("#hcmtest"),i;if(t.length==1){i=t.css("background-color").toLowerCase();t.remove();if(i!=="#878787"&&i!=="rgb(135, 135, 135)"){e.addClass("is-high-contrast");$(".btn").removeClass("btn")}}}$("[data-survey-page-form]").surveyPageForm();$("[data-previous-page-button]").on("click",function(e){$("#is_previous").val(true)});$("[data-other-text]").otherAnswerTextOption();$("[data-forced-ranking]").forcedRankingQuestion();$("[data-nps]").npsQuestion();$("[data-question-ranking]").rankingQuestion();$('[data-exit-survey-btn][href="#"]').on("click",function(e){window.close()});$("[data-radio-button-group]").radioButtonGroup();$("[data-sm-checkbox]").checkbox();$("[data-sm-emoji-button]").emojiRatingQuestion();$("[data-question-slider]").sliderQuestion();if(t.length){t.fileUploadQuestion({uploaderConfig:__UPLOADER,uploadAreaTemplateId:e})}if(typeof $("[data-question-validation-message]")[0]!="undefined"){$("[data-question-validation-message]").first().focus();$("[data-question-validation-message]")[0].scrollIntoView()}$("#fb_share_btn").fbShareBtn();i();if(SM.Touch.isTouchDevice()){SM.Touch.init(document.body)}});$(function(){if(typeof performance.mark!="undefined"){var e=[];var t=performance.getEntriesByType("mark");}})